request
count
encode-base64
database
count
if (true) {
    count
    if (true) {
        count
        encode-base64
        return-response
    } else {
        return-response
    }
} else {
    encode-base64
    database
    database
    return-response
}